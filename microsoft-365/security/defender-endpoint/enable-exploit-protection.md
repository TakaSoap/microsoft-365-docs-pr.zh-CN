---
title: 打开 Exploit Protection 以帮助缓解攻击
keywords: 攻击， 缓解， 攻击， 漏洞
description: 了解如何在 Windows 中启用 exploit protection。 Exploit Protection 可帮助保护你的设备免受恶意软件的攻击。
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.localizationpriority: medium
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.reviewer: ksarens
manager: dansimp
ms.technology: mde
ms.topic: how-to
ms.collection: m365-security-compliance
ms.date: 10/19/2021
ms.openlocfilehash: ed7b79e43d41ce746eb7c09acd7926c76360f956
ms.sourcegitcommit: bdd6ffc6ebe4e6cb212ab22793d9513dae6d798c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/08/2022
ms.locfileid: "63316025"
---
# <a name="enable-exploit-protection"></a>启用漏洞保护

**适用于：**
- [Microsoft Defender for Endpoint 计划 2](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft Defender for Endpoint 计划 1](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> [!TIP]
> 想要体验适用于终结点的 Defender？ [注册免费试用版](https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-assignaccess-abovefoldlink)。

[Exploit Protection](exploit-protection.md) 可帮助抵御使用攻击感染设备和传播的恶意软件。 Exploit Protection 包含许多可应用于操作系统或个别应用的缓解。

> [!IMPORTANT]
> .NET 2.0 与一些 Exploit Protection 功能不兼容，特别是导出地址筛选 (EAF) 和 Import Address Filtering (IAF) 。 如果已启用 .NET 2.0，则不支持使用 EAF 和 IAF。

增强的缓解体验 Toolkit (EMET) 许多功能都包含在 Exploit Protection 中。

可以使用以下任一方法单独启用每个缓解：

- [Windows 安全中心应用](#windows-security-app)
- [Microsoft Intune](#intune)
- [移动设备管理 (MDM)](#mdm)
- [Microsoft Endpoint Configuration Manager](#microsoft-endpoint-configuration-manager)
- [组策略](#group-policy)
- [PowerShell](#powershell)

默认情况下，Exploit Protection 在 Windows 10 和 Windows 11 中配置。 你可以将每个缓解设置为打开、关闭或设置为其默认值。 一些缓解功能具有更多选项。 可以将 [这些设置导出为 XML 文件，](import-export-exploit-protection-emet-xml.md) 然后将它们部署到其他设备。

还可以将缓解设置为 [审核模式](evaluate-exploit-protection.md)。 审核模式允许你测试缓解在 (并查看) 事件，而不会影响设备的正常使用。

## <a name="windows-security-app"></a>Windows 安全中心应用

1. 打开Windows 安全中心应用，选择任务栏中的防护图标，或搜索安全"开始"菜单 **应用**。

2. Select the **App & browser control** tile (or the app icon on the left menu bar) and then select **Exploit Protection settings**.

3. 转到 **计划设置** ，然后选择你要应用缓解的应用。
    - 如果已列出要配置的应用，请选择它，然后选择"编辑 **"**。
    - 如果未列出应用，请在列表顶部选择"添加程序"进行自定义，然后选择希望如何添加应用。
    - 使用 **"按程序名称** 添加"将缓解应用于具有该名称的任何正在运行的进程。 指定扩展名为 的文件。 你可以输入完整路径，将缓解限制为仅该位置中具有该名称的应用。
    - Use **Choose exact file path** to use a standard Windows Explorer file picker window to find and select the file you want.

4. 选择应用后，你将看到可应用的所有缓解的列表。 选择 **审核** 将仅在审核模式下应用缓解。 如果需要重新启动进程或应用，或者需要重新启动进程或应用，Windows。

5. 对要配置的所有应用和缓解重复步骤 3-4。

6. 在 **"系统设置** "部分下，找到要配置的缓解，然后指定以下设置之一。 未在"程序设置"部分单独 **配置的应用使用** 在此处配置的设置。
    - **默认启用**：为在特定于应用的程序设置部分中未设置此缓解的应用 **启用缓解**
    - **默认情况下关闭**：针对在特定于应用的程序设置部分中没有设置此缓解的应用 **禁用缓解**
    - **使用默认值**：根据 Windows 10 或 Windows 11 安装设置的默认配置，启用或禁用缓解;默认值 (**On** 或 **Off**) 始终在"使用每个缓解的默认标签"旁边指定

7. 对要配置的所有系统级别缓解重复步骤 6。 **完成配置** 设置后，选择"应用"。

如果你将应用添加到计划 **设置部分，** 并在那里配置个别缓解设置，则它们在"系统设置"部分中指定的相同缓解 **的配置上方会获得** 支持。 以下矩阵和示例可帮助说明默认设置如何工作：

|在程序 **设置中启用**|在系统 **设置中启用**|行为|
|:---|:---|:---|
|是|否|如程序 **设置中的定义**|
|是|是|如程序 **设置中的定义**|
|否|是|如系统 **设置中的定义**|
|否|是|默认，如 **使用默认选项** 中定义|

### <a name="example-1-mikael-configures-data-execution-prevention-in-system-settings-section-to-be-off-by-default"></a>示例 1：M在系统设置部分中将"数据执行保护"配置为默认关闭

M一el 将应用 *test.exe* 程序 **设置部分** 。 在该应用的选项中，在"数据执行保护 (**DEP)**"下，M一el 启用"覆盖系统设置"选项，将开关设置为 **"开"**。 "程序设置"部分未列出 **任何其他** 应用。

结果是 DEP 仅对 *test.exe启用。* 所有其他应用将不会应用 DEP。

### <a name="example-2-josie-configures-data-execution-prevention-in-system-settings-to-be-off-by-default"></a>示例 2：Josie 在系统设置中将数据执行保护配置为默认关闭

Josie 将应用 *test.exe* 程序 **设置部分** 。 在该应用的选项中，在"数据执行保护 (**DEP**) "下，Josie 启用"覆盖系统设置"选项，将开关设置为 **"开"**。

Josie 还将 *应用miles.exe添加到*"程序设置"部分，并将"控制流保护" (**CFG**) **"打开"**。 Josie 不会为 DEP 或该应用的其他任何缓解启用替代系统设置选项。

结果是为启用 DEP *的test.exe*。 不会为任何其他应用启用 DEP *，包括miles.exe*。 CFG *将启用miles.exe*。

1. 通过在任务栏Windows 安全中心防护图标或搜索"开始"菜单来打开 **Windows 安全中心。**

2. 选择应用 **&浏览器控制** 磁贴 (或左侧菜单栏上的应用图标) 选择 Exploit **Protection**。

3. 转到 **计划设置** ，然后选择你要应用缓解的应用。<br/>
    - 如果已列出要配置的应用，请选择它，然后选择"编辑 **"**。
    - 如果未列出应用，请在列表顶部选择"添加程序"进行自定义，然后选择希望如何添加应用。<br/>
      - 使用 **"按程序名称** 添加"将缓解应用于具有该名称的任何正在运行的进程。 指定具有扩展名的文件。 你可以输入完整路径，将缓解限制为仅该位置中具有该名称的应用。
      - Use **Choose exact file path** to use a standard Windows Explorer file picker window to find and select the file you want.

4. 选择应用后，你将看到可应用的所有缓解的列表。 选择 **审核** 将仅在审核模式下应用缓解。 如果需要重新启动进程或应用，或者需要重新启动进程或应用，你将收到Windows。

5. 对要配置的所有应用和缓解重复步骤 3-4。 **完成配置** 设置后，选择"应用"。

## <a name="intune"></a>Intune

1. 登录到 [Azure 门户并打开](https://portal.azure.com) Intune。

2. 转到" **设备配置文件"** \> **"** \> **创建配置文件"**。

3. 命名配置文件，选择"**Windows 10及更高版本"和**"**终结点保护"**。

   :::image type="content" source="images/create-endpoint-protection-profile.png" alt-text="创建终结点保护配置文件。":::

4. 选择 **配置** \> **Windows Defender攻击防护** \> **Exploit Protection**。

5. Upload [Exploit Protection 设置创建 XML](/windows/client-management/mdm/policy-csp-exploitguard) 文件：

   :::image type="content" source="images/enable-ep-intune.png" alt-text="在 Intune 中启用网络保护。":::

6. 选择 **"确定** "保存每个打开的边栏选项卡，然后选择"创建 **"**。

7. 选择配置文件 **分配** 选项卡，将策略分配给所有用户 **&所有设备，****然后选择保存。**

## <a name="mdm"></a>MDM

使用 [./Vendor/MSFT/Policy/Config/ExploitGuard/ExploitProtectionSettings](/windows/client-management/mdm/policy-csp-exploitguard) 配置服务提供程序 (CSP) 启用或禁用 Exploit Protection 缓解或使用审核模式。

## <a name="microsoft-endpoint-manager"></a>Microsoft Endpoint Manager

1. 在Microsoft Endpoint Manager，转到终结点 **安全** \> **攻击面减少**。

2. 选择 **创建策略** \> **平台**，对于 **配置文件，** 选择 **Exploit Protection**。 然后选择“创建”。

3. 指定名称和说明，然后选择"下一步 **"**。

4. 选择 **"选择 XML** 文件"并浏览到 Exploit Protection XML 文件的位置。 选择该文件，然后选择"下一 **步"**。

5. 必要时 **配置范围** 标记 **和** 分配。

6. 在 **"查看 + 创建"** 下，查看配置设置，然后选择"创建 **"**。

## <a name="microsoft-endpoint-configuration-manager"></a>Microsoft Endpoint Configuration Manager

1. In Microsoft Endpoint Configuration Manager， go to **Assets and Compliance** \> **Endpoint Protection** \> **Windows Defender Exploit Guard**.

2. 选择 **"主页** \> **创建攻击防护策略"**。

3. 指定名称和说明，选择 Exploit **Protection**，然后选择"下一步 **"**。

4. 浏览到 Exploit Protection XML 文件的位置，然后选择"下一 **步"**。

5. 查看设置，然后选择"下 **一** 步"创建策略。

6. 创建策略后，选择"关闭 **"**。

## <a name="group-policy"></a>组策略

1. 在组策略管理设备上，打开组 [策略管理控制台](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc731212(v=ws.11))，右键单击要配置的组策略对象，**然后单击编辑。**

2. 在组 **策略管理编辑器中** ，转到计算机 **配置，** 然后选择 **管理模板**。

3. 展开树以 **Windows Exploit** \> **Guard exploit Protection** \>  \> Windows Defender **使用一组常见的 Exploit Protection 设置的组件**。

4. 选择 **"** 已启用"并键入 XML 文件 [的位置](/windows/client-management/mdm/policy-csp-exploitguard)，然后选择"确定 **"**。

## <a name="powershell"></a>PowerShell

可以使用 PowerShell 动词或 `Get` `Set` cmdlet `ProcessMitigation`。 使用 `Get` 将列出设备上已启用的任何缓解的当前配置状态 - `-Name` 添加 cmdlet 和 app exe 以查看仅该应用的缓解：

```PowerShell
Get-ProcessMitigation -Name processName.exe
```

> [!IMPORTANT]
> 尚未配置的系统级别缓解将显示 状态 `NOTSET`。
>
> - 对于系统级别的设置， `NOTSET` 指示已应用该缓解的默认设置。
> - 对于应用级别的设置 `NOTSET` ，指示将应用缓解的系统级别设置。
> 每个系统级别缓解的默认设置都可以看到在Windows 安全中心。

使用以下 `Set` 格式配置每个缓解：

```PowerShell
Set-ProcessMitigation -<scope> <app executable> -<action> <mitigation or options>,<mitigation or options>,<mitigation or options>
```

其中：

- \<Scope\>:
  - `-Name` 指示缓解应应用于特定应用。 在此标志后指定应用的可执行文件。
    - `-System` 指示应在系统级别应用缓解
- \<Action\>:
  - `-Enable` 启用缓解
  - `-Disable` 禁用缓解
- \<Mitigation\>:
  - 缓解的 cmdlet 以及任何子选项 (空格) 。 每个缓解用逗号分隔。

例如，若要使用 ATLnk 仿真为数据执行保护 (DEP) 缓解，并为 *文件夹 C：\Apps\LOB\tests* 中名为 *testing.exe* 的可执行文件启用缓解，并阻止该可执行文件创建子进程，可使用以下命令：

```PowerShell
Set-ProcessMitigation -Name c:\apps\lob\tests\testing.exe -Enable DEP, EmulateAtlThunks, DisallowChildProcessCreation
```

> [!IMPORTANT]
> 使用逗号分隔每个缓解选项。

如果要在系统级别应用 DEP，请使用以下命令：

```PowerShell
Set-Processmitigation -System -Enable DEP
```

若要禁用缓解，你可以将 替换为 `-Enable` `-Disable`。 但是，对于应用级别的缓解，此操作会强制仅为该应用禁用缓解。

如果需要将缓解恢复为 `-Remove` 系统默认值，还需要包括 cmdlet，如以下示例所示：

```PowerShell
Set-Processmitigation -Name test.exe -Remove -Disable DEP
```

下表列出了 **单独的缓解 (** 和审核（如果可用`-Enable``-Disable`) 或 cmdlet 参数使用）。<br/><br/>

|缓解类型|适用对象|缓解 cmdlet 参数关键字|审核模式 cmdlet 参数|
|---|---|---|---|
|控制流保护 (CFG) |系统和应用级别|`CFG`, `StrictCFG`, `SuppressExports`|审核不可用|
|数据执行保护(DEP)|系统和应用级别|`DEP`, `EmulateAtlThunks`|审核不可用|
|强制图像随机化(强制 ASLR)|系统和应用级别|`ForceRelocateImages`|审核不可用|
|随机内存分配(由下而上 ASLR)|系统和应用级别|`BottomUp`, `HighEntropy`|审核不可用
|验证异常链(SEHOP)|系统和应用级别|`SEHOP`, `SEHOPTelemetry`|审核不可用|
|验证堆完整性|系统和应用级别|`TerminateOnError`|审核不可用|
|任意代码防护(ACG)|仅应用级别|`DynamicCode`|`AuditDynamicCode`|
|阻止低完整性图像|仅应用级别|`BlockLowLabel`|`AuditImageLoad`|
|阻止远程图像|仅应用级别|`BlockRemoteImages`|审核不可用|
|阻止不受信任的字体|仅应用级别|`DisableNonSystemFonts`|`AuditFont`, `FontAuditOnly`|
|代码完整性防护|仅应用级别|`BlockNonMicrosoftSigned`, `AllowStoreSigned`|AuditMicrosoftSigned、AuditStoreSigned|
|禁用扩展点|仅应用级别|`ExtensionPoint`|审核不可用|
|禁用 Win32k 系统调用|仅应用级别|`DisableWin32kSystemCalls`|`AuditSystemCall`|
|不允许子进程|仅应用级别|`DisallowChildProcessCreation`|`AuditChildProcess`|
|导出地址筛选(EAF)|仅应用级别|`EnableExportAddressFilterPlus`、 `EnableExportAddressFilter` <a href="#r1" id="t1">\[1\]</a>|审核不可用 <a href="#r2" id="t2">\[2\]</a>|
|导入地址筛选(IAF)|仅应用级别|`EnableImportAddressFilter`|审核不可用 <a href="#r2" id="t2">\[2\]</a>|
|模拟执行(SimExec)|仅应用级别|`EnableRopSimExec`|审核不可用 <a href="#r2" id="t2">\[2\]</a>|
|验证 API 调用(CallerCheck)|仅应用级别|`EnableRopCallerCheck`|审核不可用 <a href="#r2" id="t2">\[2\]</a>|
|验证处理使用情况|仅应用级别|`StrictHandle`|审核不可用|
|验证映像依赖项完整性|仅应用级别|`EnforceModuleDepencySigning`|审核不可用|
|验证堆栈完整性(StackPivot)|仅应用级别|`EnableRopStackPivot`|审核不可用 <a href="#r2" id="t2">\[2\]</a>|

<a href="#t1" id="r1">\[1\]</a>：使用以下格式为进程启用 DLL 的 EAF 模块：

```PowerShell
Set-ProcessMitigation -Name processName.exe -Enable EnableExportAddressFilterPlus -EAFModules dllName1.dll,dllName2.dll
```

<a href="#t2" id="r2">\[2\]</a>：无法通过 PowerShell cmdlet 审核此缓解。

## <a name="customize-the-notification"></a>自定义通知

有关在触发规则并阻止应用或文件时自定义通知的信息，[请参阅Windows 安全中心。](/windows/security/threat-protection/windows-defender-security-center/windows-defender-security-center)

## <a name="see-also"></a>另请参阅

- [评估 Exploit Protection](evaluate-exploit-protection.md)
- [配置和审核 Exploit Protection 缓解](customize-exploit-protection.md)
- [导入、导出和部署 Exploit Protection 配置](import-export-exploit-protection-emet-xml.md)
