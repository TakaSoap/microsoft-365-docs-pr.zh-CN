---
title: 调查异常检测警报
f1.keywords:
- NOCSH
ms.author: v-tophillips
author: v-tophillips
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
ms.collection: m365-security-compliance
ms.localizationpriority: high
search.appverid:
- MOE150
- MET150
description: 调查异常检测警报。
ms.openlocfilehash: bc82c0a8145b783ea914dd7eec32f3a5f7c6d05e
ms.sourcegitcommit: df1ad7118c4a95a310a4f17124322a6ae6ace26f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/11/2021
ms.locfileid: "60268870"
---
# <a name="investigate-anomaly-detection-alerts"></a>调查异常检测警报

 Microsoft 应用治理提供针对恶意活动的安全检测和警报。 本指南旨在为你提供有关每个警报的一般和实用信息，以帮助你完成调查和修正任务。 本指南包含有关触发警报的条件的一般信息。 由于异常检测本质上不可确定，因此只有当存在偏离规范的行为时，才会触发异常检测。 最后，由于一些警报可能处于预览状态，因此请定期查看官方文档以了解更新的警报状态。

## <a name="mitre-attck"></a>MITRE ATT&CK

为了更轻松地映射 Microsoft 应用治理警报和熟悉的 MITRE ATT&CK 矩阵之间的关系，我们已按其相应的 MITRE ATT&CK 策略对警报进行了分类。 借助此附加参考，可以更轻松地了解触发应用治理警报时可能使用的可疑攻击技术。

本指南提供有关调查和修正以下类别中应用治理警报的信息。

- 初始访问
- 执行
- 持久性
- 特权提升
- 防御规避
- 凭据访问
- 发现
- 横向移动
- 集合
- 外泄
- 影响

## <a name="security-alert-classifications"></a>安全警报分类

经过适当调查后，所有 Microsoft 应用治理警报都可以归类为以下活动类型之一:

- 真阳性(TP): 针对确认为恶意活动的警报。
- 良性真阳性(B-TP): 针对可疑但非恶意活动的警报，例如渗透测试或其他授权的可疑操作。
- 假阳性(FP): 针对非恶意活动的警报。

## <a name="general-investigation-steps"></a>一般调查步骤

在调查任何类型的警报时，请使用以下一般准则，从而在应用推荐操作之前更清楚地了解潜在威胁。

- 查看应用严重性级别，并与租户中的其余应用进行比较。 这样的查看将帮助识别租户中会带来更大风险的应用。
- 如果标识了 TP，请查看所有应用活动以了解影响。例如，查看以下应用信息：

  - 授予访问权限的范围
  - 异常行为  
  - IP 地址和位置

## <a name="initial-access-alerts"></a>初始访问警报

本部分介绍了表明恶意应用可能试图保持其在组织中的立足点的警报。  

### <a name="app-created-recently-has-low-consent-rate"></a>最近创建的应用的同意率较低

**严重性**： 低

此检测可识别最近创建的、同意率较低的 OAuth 应用。 这可能表示恶意或有风险的应用会诱使用户授权非法许可。

**TP 还是 FP?**

- **TP**：如果能够确认 OAuth 应用是从未知源传送的，则会指示正确报告。

  **推荐操作**：查看应用的显示名称、回复 URL、域。 根据调查，你可以选择禁止访问此应用。 查看此应用请求的权限级别以及授予访问权限的用户。

- **FP**： 如果在调查后，可以确认应用在组织中具有合法的业务用途。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看应用完成的所有活动。  
1. 如果你怀疑某个应用可疑，我们建议你调查该应用在不同应用商店中的名称和“回复”URL。 在检查应用商店时，请重点关注以下类型的应用:
   - 最近创建的应用
   - 具有异常显示名称的应用
   - 具有可疑回复域的应用
1. 如果仍然怀疑某个应用可疑，则可以研究应用显示名称和回复域。

### <a name="app-with-bad-url-reputation"></a>URL 信誉不佳的应用

**严重性:** 中等

此检测可识别 URL 信誉不佳的 OAuth 应用。  

**TP 还是 FP?**

- **TP**：如果能够确认 OAuth 应用从未知源传递并重定向到可疑 URL，则会指示正确报告。

  **推荐操作**：查看应用请求的回复 URL 和范围。 根据调查，你可以选择禁止访问此应用。 查看此应用请求的权限级别以及授予访问权限的用户。

- **FP**： 如果在调查后，可以确认应用在组织中具有合法的业务用途。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看应用完成的所有活动。  
1. 如果你怀疑某个应用可疑，我们建议你调查该应用在不同应用商店中的名称和“回复”URL。 在检查应用商店时，请重点关注以下类型的应用:
   - 最近创建的应用
   - 具有异常显示名称的应用
   - 具有可疑回复域的应用
1. 如果仍然怀疑某个应用可疑，则可以研究应用显示名称和回复域。

### <a name="encoded-app-name-with-suspicious-consent-scopes"></a>具有可疑同意范围的已编码应用名称

**严重性:** 中等

**说明**: 此检测会识别具有字符(例如 Unicode 或已编码字符)的 OAuth 应用，其针对可疑同意范围进行请求并通过图形 API 访问用户邮件文件夹。 此警报可能表明试图将恶意应用伪装成已知且受信任的应用的行为，以便攻击者可以误导用户同意恶意应用。

**TP 还是 FP?**

- **TP**: 如果你可以确认 OAuth 应用已使用从未知源传递的可疑范围对显示名称进行编码，则表明为真阳性。  

  **推荐操作**: 查看此应用请求的权限级别以及授予访问权限的用户。 根据调查，你可以选择禁止访问此应用。

  要禁止访问应用，请在 OAuth 应用页面中，在要禁止应用显示的行中，选择禁用图标。 你可以选择是否希望告知用户其安装和授权的应用已被禁用。 此通知会告知用户应用将被禁用，且他们将无法访问已连接应用。 如果不希望告知用户，请取消选择“在对话框中通知授予此禁止应用访问权限的用户”。 我们建议你告知应用用户其应用即将被禁止使用。

- **FP**: 如果你要确认应用具有已编码名称，但在组织中却具有合法的商业用途。

  **推荐操作**: 关闭警报。

**了解违规的范围**

请遵循如何 [调查危险的 OAuth 应用](/cloud-app-security/investigate-risky-oauth) 的教程。

### <a name="oauth-app-with-read-scopes-have-suspicious-reply-url"></a>具有读取范围的 OAuth 应用具有可疑的“回复”URL

**严重性:** 中等

**说明**: 此检测会识别只具有“读取”范围(例如 User.Read、People.Read、Contacts.Read、Mail.Read、Contacts.Read.Shared)、通过图形 API 重定向到可疑的“回复”URL 的 OAuth 应用。 此活动试图表明具有较低权限(例如“读取”范围)的恶意应用可能被用于进行用户帐户侦查。

**TP 还是 FP?**

- **TP**: 如果你能够确认具有读取范围的 OAuth 应用从未知源传递并重定向到可疑 URL，则表明为真阳性。

  **推荐操作**: 查看应用请求的“回复”URL 和范围。 根据调查，你可以选择禁止访问此应用。 查看此应用请求的权限级别以及授予访问权限的用户。

  要禁止访问应用，请在 OAuth 应用页面中，在要禁止应用显示的行中，选择禁用图标。 你可以选择是否希望告知用户其安装和授权的应用已被禁用。 此通知会告知用户应用将被禁用，且他们将无法访问已连接应用。 如果不希望告知用户，请取消选择“在对话框中通知授予此禁止应用访问权限的用户”。 我们建议你告知应用用户其应用即将被禁止使用。

- **B-TP**: 如果经过调查，你可以确认此应用在组织中具有合法的商业用途。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看应用完成的所有活动。
1. 如果你怀疑某个应用可疑，我们建议你调查该应用在不同应用商店中的名称和“回复”URL。 在检查应用商店时，请重点关注以下类型的应用:
   - 最近创建的应用。
   - 具有可疑“回复”URL 的应用
   - 最近未更新的应用。 缺少更新可能表明该应用不再获得支持。
1. 如果你仍然怀疑某个应用可疑，可以联机研究应用名称、发布者名称以及“回复”URL  

### <a name="app-with-unusual-display-name-and-unusual-tld-inreply-domain"></a>回复域中具有异常显示名称和异常 TLD 的应用  

**严重性:** 中等  

此检测标识具有异常显示名称的应用，并通过图形 API重定向到具有异常顶级域 （TLD） 的可疑回复域。 此警报可能表明试图将恶意应用伪装成已知且受信任的应用的行为，以便攻击者可以误导用户同意恶意应用。  

**TP 还是 FP?**

- **TP**：如果能够确认具有异常显示名称的应用从未知源传送，并重定向到具有异常顶级域的可疑域  

    **请求操作**：查看应用的显示名称和回复域。 根据调查，你可以选择禁止访问此应用。 查看此应用请求的权限级别以及授予访问权限的用户。

- **FP**： 如果在调查后，可以确认应用在组织中具有合法的业务用途。

    **推荐操作**: 关闭警报。

**了解违规的范围**

查看应用完成的所有活动。 如果你怀疑某个应用可疑，我们建议你调查该应用在不同应用商店中的名称和“回复”URL。 在检查应用商店时，请重点关注以下类型的应用:

- 最近创建的应用
- 具有异常显示名称的应用
- 具有可疑回复域的应用

如果仍然怀疑某个应用可疑，则可以研究应用显示名称和回复域。

## <a name="persistence-alerts"></a>持久性警报

本部分介绍了表明恶意行动者可能试图保持其在组织中的立足点的警报。

### <a name="app-made-anomalous-graph-calls-to-exchange-workload-post-certificate-update-or-addition-of-new-credentials"></a>应用在证书更新或添加新凭据后对 Exchange 工作负荷进行了异常图形调用

**严重性:** 中等

**MITRE ID**：T1098.001, T1114

当业务线 (LOB) 应用更新证书/机密或添加新凭据，并在证书更新或添加新凭据后的几天内，通过机器学习算法观察到异常活动或通过图形 API 大量使用 Exchange 工作负荷时，此检测会触发警报。

**TP 还是 FP?**

- **TP**：如果能够确认 LOB 应用通过图形 API 执行了异常活动/大量使用 Exchange 工作负载  

  **推荐操作**: 暂时禁用应用并重置密码，然后重启应用。

- **FP**：如果可以确认 LOB 应用没有执行异常活动，或应用想要执行异常大量的图形调用。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看此应用执行的所有活动。
1. 查看应用授予的范围。
1. 查看与此应用关联的用户活动。

### <a name="app-with-suspicious-oauth-scope-was-flagged-high-risk-by-machine-learning-model-made-graph-calls-to-read-email-and-created-inbox-rule"></a>具有可疑 OAuth 范围的应用被机器学习模型标记为高风险，进行了图形调用以读取电子邮件并创建了收件箱规则

**严重性:** 中等

**MITRE ID**：T1137.005, T1114

此检测识别被机器学习模型标记为高风险的、同意可疑范围、创建可疑的收件箱规则，然后通过图形 API 访问用户邮件文件夹和邮件的 OAuth 应用。 收件箱规则(例如将所有或特定电子邮件转发到另一电子邮件帐户)以及访问电子邮件并发送到另一电子邮件帐户的图形调用可能会试图泄露组织中的信息。

**TP 还是 FP?**

- **TP**：如果可以确认收件箱规则由具有从未知源传递的可疑范围的 OAuth 第三方应用创建，则会指示为正确报告。

  **推荐操作**: 禁用和删除应用，重置密码，并删除收件箱规则。

请遵循如何使用 Azure Active Directory 重置密码的教程以及如何删除收件箱规则的教程。

- **FP**: 如果你可以确认应用出于合法原因为新的或个人外部电子邮件帐户创建收件箱规则。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看应用完成的所有活动。
1. 查看应用授予的范围。
1. 查看应用创建的收件箱规则操作和条件。

### <a name="app-with-suspicious-oauth-scope-made-graph-calls-to-read-email-and-created-inbox-rule"></a>具有可疑 OAuth 作用域的应用进行了图形调用以读取电子邮件并创建了收件箱规则  

**严重性:** 中等

**MITRE ID 的**: T1137.005、T1114  

此检测会识别同意可疑范围、创建可疑的收件箱规则，然后通过图形 API 访问用户邮件文件夹和邮件的 OAuth 应用。 收件箱规则(例如将所有或特定电子邮件转发到另一电子邮件帐户)以及访问电子邮件并发送到另一电子邮件帐户的图形调用可能会试图泄露组织中的信息。  

**TP 还是 FP?**

- **TP**: 如果你可以确认收件箱规则由具有从未知源传递的可疑范围的 OAuth 第三方应用创建，则表明为真阳性。

  **推荐操作**: 禁用和删除应用，重置密码，并删除收件箱规则。

  请遵循如何使用 Azure Active Directory 重置密码的教程以及如何删除收件箱规则的教程。

- **FP**: 如果你可以确认应用出于合法原因为新的或个人外部电子邮件帐户创建收件箱规则。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看应用完成的所有活动。
1. 查看应用授予的范围。
1. 查看应用创建的收件箱规则操作和条件。

### <a name="app-accessed-from-unusual-location-post-certificate-update"></a>证书更新后从异常位置访问的应用

**严重性**： 低

**MITRE ID**： T1098

当业务线 （LOB） 应用更新证书/机密时，此检测会触发警报;在证书更新后的几天内，将从最近未看到或从未访问过的异常位置访问应用。

**TP 还是 FP?**

- **TP**：如果能够确认 LOB 应用是否从异常位置访问并通过图形 API执行了异常活动。

    **推荐操作**: 暂时禁用应用并重置密码，然后重启应用。

- **FP**：如果你能够确认 LOB 应用是出于合法目的从异常位置访问的，并且没有执行任何异常活动。

    **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看此应用执行的所有活动。
1. 查看应用授予的范围。
1. 查看与此应用关联的用户活动。

### <a name="app-accessed-from-unusual-location-made-anomalous-graph-calls-post-certificate-update"></a>从异常位置访问的应用在证书更新后进行了异常图形调用

**严重性:** 中等

**MITRE ID**： T1098

当业务线 （LOB） 应用更新证书/机密时，此检测会触发警报;在证书更新后的几天内，会从最近未看到或从未访问过的异常位置访问应用，并使用机器学习算法通过图形 API观察到异常活动或使用情况。

**TP 还是 FP?**

- **TP**：如果能够确认 LOB 应用通过异常位置的图形 API执行了异常活动/使用情况。

    **推荐操作**: 暂时禁用应用并重置密码，然后重启应用。

- **FP**：如果你能够确认 LOB 应用是出于合法目的从异常位置访问的，并且没有执行任何异常活动。

    **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看此应用执行的所有活动。
1. 查看应用授予的范围。
1. 查看与此应用关联的用户活动。

## <a name="discovery-alerts"></a>发现警报

### <a name="app-performed-drive-enumeration"></a>应用执行的驱动器枚举

**严重性:** 中等

**MITRE ID**：T1087

此检测识别在机器学习模型检测下，使用图形 API 在 OneDrive 文件上执行枚举的 OAuth 应用。  

**TP 还是 FP?**

- **TP**：如果能够确认 LOB 应用通过图形 API 对 OneDrive 执行了异常的活动/有异常使用情况。

  **推荐操作**：禁用、删除应用并重置密码。

- **FP**：如果可以确认应用未执行任何异常活动。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看此应用执行的所有活动。
1. 查看应用授予的范围。
1. 查看与此应用关联的用户活动。

## <a name="collection-alerts"></a>集合警报

本部分介绍了表明恶意行动者可能试图从组织收集与其目标相关的数据的警报。

### <a name="app-made-anomalous-graph-calls-to-read-e-mail"></a>应用执行异常图形调用以读取电子邮件

**严重性:** 中等

**MITRE ID**: T1114

此检测会识别业务线(LOB) OAuth 应用通过图形 API 访问异常大量用户的邮件文件夹和邮件的时间，这可能表明试图泄露组织信息的行为。

**TP 还是 FP?**

- **TP**: 如果你可以确认异常图形活动由业务线(LOB) OAuth 应用执行，则表明为正阳性。

  **推荐操作**: 暂时禁用应用并重置密码，然后重启应用。 请遵循如何使用 Azure Active Directory 重置密码的教程。

- **FP**： 如果你可以确认应用旨在执行异常大量的图形调用。

  **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看此应用执行的事件的活动日志，从而更好地了解其他读取电子邮件并尝试收集用户敏感电子邮件信息的图形活动。
1. 监视向应用添加的意外凭据。

### <a name="app-creates-inbox-rule-and-made-unusual-email-searches-activities"></a>应用创建收件箱规则并进行异常的电子邮件搜索活动

**严重性:** 中等

**MITRE ID**：T1137、T1114  

此检测标识同意高特权范围的应用，创建可疑收件箱规则，并通过图形 API在用户邮件文件夹中进行异常的电子邮件搜索活动。 这可能表示试图入侵你的组织，例如攻击者尝试通过图形 API搜索和收集组织中的特定电子邮件。

**TP 还是 FP?**

- **TP**：如果能够确认通过具有高权限范围的 OAuth 应用图形 API完成的任何特定电子邮件搜索和收集，并且应用是从未知源传递的。

    **推荐操作**: 禁用和删除应用，重置密码，并删除收件箱规则。

- **FP**：如果你确认应用已通过图形 API执行了特定的电子邮件搜索和收集，并且出于合法原因创建了新的或个人外部电子邮件帐户的收件箱规则。

    **推荐操作**: 关闭警报。

**了解违规的范围**

1. 查看应用完成的所有活动。
1. 查看应用授予的范围。
1. 查看应用创建的任何收件箱规则操作。
1. 查看应用完成的任何电子邮件搜索活动。

### <a name="appmade-onedrive--sharepoint-search-activities-and-created-inbox-rule"></a>应用进行了 OneDrive / SharePoint 搜索活动并创建了收件箱规则  

**严重性:** 中等

**MITRE ID 的**：T1137、T1213

此检测可识别应用是否同意了高特权范围，创建了可疑收件箱规则，并通过 Graph API进行了异常的 SharePoint 或 OneDrive 搜索活动。 这可能指示对你的组织的尝试入侵，例如攻击者尝试通过 Graph API 从组织中搜索和收集 SharePoint 或 OneDrive 中的特定数据。  

**TP 还是 FP？**

- **TP**：如果能够确认任何特定数据来自由具有高特权范围的 OAuth 应用通过 Graph API 进行的 SharePoint 或 OneDrive 搜索和收集，并且应用是从未知源传递的。  

  **建议操作**：禁用和删除应用、重置密码，并删除收件箱规则。  

- **FP**：如果能够确认应用已由 OAuth 应用通过 Graph API 执行了来自 SharePoint 或 OneDrive 搜索和收集的特定数据，并且出于合法原因创建了新的或个人外部电子邮件帐户的收件箱规则。  

  **建议操作**：关闭警报  

**了解违规的范围**

1. 查看应用完成的所有活动。  
1. 查看应用授予的范围。  
1. 查看应用创建的任何收件箱规则操作。  
1. 查看应用执行的任何 SharePoint 或 OneDrive 搜索活动。

### <a name="app-made-high-volume-of-importance-mail-read-and-created-inbox-rule"></a>应用读取了大量重要邮件，并创建了收件箱规则

**严重性：** 中等  

**MITRE ID**：T1137、T1114

此检测可识别应用是否同意高特权范围、创建可疑收件箱规则并通过 Graph API 进行大量重要邮件读取活动。 这可能表示试图入侵你的组织，例如攻击者尝试通过 Graph API 读取组织中的高重要性电子邮件。  

**TP 还是 FP？**

- **TP**：如果能够确认由高特权范围的 OAuth 应用通过 Graph API 读取大量重要电子邮件，并且该应用是从未知源传递的。  

  **建议操作**：禁用和删除应用、重置密码，并删除收件箱规则。  

- **FP**：如果能够确认应用已通过 Graph API 执行了高重要性电子邮件读取，并且出于合法原因创建了新的或个人外部电子邮件帐户的收件箱规则。  

  **建议操作**：关闭警报  

**了解违规的范围**

1. 查看应用完成的所有活动。  
1. 查看应用授予的范围。  
1. 查看应用创建的任何收件箱规则操作。  
1. 查看应用执行的任何高重要性电子邮件读取活动。  
